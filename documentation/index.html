<!DOCTYPE html>  
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>index</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
/* 
   This document has been created with Marked.app <http://markedapp.com>, Copyright 2011 Brett Terpstra
   Please leave this notice in place, along with any additional credits below.
   ---------------------------------------------------------------
   Title: GitHub
   Author: Brett Terpstra
   Description: Github README style. Includes theme for Pygmentized code blocks.
*/
html,body{color:black}*{margin:0;padding:0}body{font:13.34px helvetica,arial,freesans,clean,sans-serif;-webkit-font-smoothing:antialiased;line-height:1.4;padding:3px;background:#fff;border-radius:3px;-moz-border-radius:3px;-webkit-border-radius:3px}p{margin:1em 0}a{color:#4183c4;text-decoration:none}#wrapper{background-color:#fff;border:3px solid #eee!important;padding:0 30px;margin:15px}#wrapper{font-size:14px;line-height:1.6}#wrapper>*:first-child{margin-top:0!important}#wrapper>*:last-child{margin-bottom:0!important}h1,h2,h3,h4,h5,h6{margin:0;padding:0}h1{margin:15px 0;padding-bottom:2px;font-size:24px;border-bottom:1px solid #eee}h2{margin:20px 0 10px 0;font-size:18px}h3{margin:20px 0 10px 0;padding-bottom:2px;font-size:14px;border-bottom:1px solid #ddd}h4{font-size:14px;line-height:26px;padding:18px 0 4px;font-weight:bold;text-transform:uppercase}h5{font-size:13px;line-height:26px;padding:14px 0 0;font-weight:bold;text-transform:uppercase}h6{color:#666;font-size:14px;line-height:26px;padding:18px 0 0;font-weight:normal;font-variant:italic}hr{background:transparent url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAYAAAAECAYAAACtBE5DAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBNYWNpbnRvc2giIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OENDRjNBN0E2NTZBMTFFMEI3QjRBODM4NzJDMjlGNDgiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OENDRjNBN0I2NTZBMTFFMEI3QjRBODM4NzJDMjlGNDgiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo4Q0NGM0E3ODY1NkExMUUwQjdCNEE4Mzg3MkMyOUY0OCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo4Q0NGM0E3OTY1NkExMUUwQjdCNEE4Mzg3MkMyOUY0OCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PqqezsUAAAAfSURBVHjaYmRABcYwBiM2QSA4y4hNEKYDQxAEAAIMAHNGAzhkPOlYAAAAAElFTkSuQmCC) repeat-x 0 0;border:0 none;color:#ccc;height:4px;margin:20px 0;padding:0}#wrapper>h2:first-child,#wrapper>h1:first-child,#wrapper>h1:first-child+h2{border:0;margin:0;padding:0}#wrapper>h3:first-child,#wrapper>h4:first-child,#wrapper>h5:first-child,#wrapper>h6:first-child{margin:0;padding:0}h4+p,h5+p,h6+p{margin-top:0}li p.first{display:inline-block}ul,ol{margin:15px 0 15px 25px}ul li,ol li{margin-top:7px;margin-bottom:7px}ul li>*:last-child,ol li>*:last-child{margin-bottom:0}ul li>*:first-child,ol li>*:first-child{margin-top:0}#wrapper>ul,#wrapper>ol{margin-top:21px;margin-left:36px}dl{margin:0;padding:20px 0 0}dl dt{font-size:14px;font-weight:bold;line-height:normal;margin:0;padding:20px 0 0}dl dt:first-child{padding:0}dl dd{font-size:13px;margin:0;padding:3px 0 0}blockquote{margin:14px 0;border-left:4px solid #ddd;padding-left:11px;color:#555}table{border-collapse:collapse;margin:20px 0 0;padding:0}table tr{border-top:1px solid #ccc;background-color:#fff;margin:0;padding:0}table tr:nth-child(2n){background-color:#f8f8f8}table tr th,table tr td{border:1px solid #ccc;text-align:left;margin:0;padding:6px 13px}img{max-width:100%;height:auto}code,tt{margin:0 2px;padding:2px 5px;white-space:nowrap;border:1px solid #ccc;background-color:#f8f8f8;border-radius:3px;-moz-border-radius:3px;-webkit-border-radius:3px;font-size:12px}pre>code{margin:0;padding:0;white-space:pre;border:0;background:transparent;font-size:13px}.highlight pre,pre{background-color:#f8f8f8;border:1px solid #ccc;font-size:13px;line-height:19px;overflow:auto;padding:6px 10px;border-radius:3px;-moz-border-radius:3px;-webkit-border-radius:3px}#wrapper>pre,#wrapper>div.highlight{margin:10px 0 0}pre code,pre tt{background-color:transparent;border:0}#wrapper{background-color:#fff;border:1px solid #cacaca;padding:30px}.poetry pre{font-family:Georgia,Garamond,serif!important;font-style:italic;font-size:110%!important;line-height:1.6em;display:block;margin-left:1em}.poetry pre code{font-family:Georgia,Garamond,serif!important}sup,sub,a.footnote{font-size:1.4ex;height:0;line-height:1;vertical-align:super;position:relative}sub{vertical-align:sub;top:-1px}@media print{body{background:#fff}img,pre,blockquote,table,figure{page-break-inside:avoid}#wrapper{background:#fff;border:0}code{background-color:#fff;color:#444!important;padding:0 .2em;border:1px solid #dedede}pre code{background-color:#fff!important;overflow:visible}pre{background:#fff}}@media screen{body.inverted,.inverted #wrapper,.inverted hr .inverted p,.inverted td,.inverted li,.inverted h1,.inverted h2,.inverted h3,.inverted h4,.inverted h5,.inverted h6,.inverted th,.inverted .math,.inverted caption,.inverted dd,.inverted dt,.inverted blockquote{color:#eee!important;border-color:#555}.inverted td,.inverted th{background:#333}.inverted pre,.inverted code,.inverted tt{background:#444!important}.inverted h2{border-color:#555}.inverted hr{border-color:#777;border-width:1px!important}::selection{background:rgba(157,193,200,.5)}h1::selection{background-color:rgba(45,156,208,.3)}h2::selection{background-color:rgba(90,182,224,.3)}h3::selection,h4::selection,h5::selection,h6::selection,li::selection,ol::selection{background-color:rgba(133,201,232,.3)}code::selection{background-color:rgba(0,0,0,.7);color:#eee}code span::selection{background-color:rgba(0,0,0,.7)!important;color:#eee!important}a::selection{background-color:rgba(255,230,102,.2)}.inverted a::selection{background-color:rgba(255,230,102,.6)}td::selection,th::selection,caption::selection{background-color:rgba(180,237,95,.5)}.inverted{background:#0b2531}.inverted #wrapper,.inverted{background:rgba(37,42,42,1)}.inverted a{color:rgba(172,209,213,1)}}.highlight .c{color:#998;font-style:italic}.highlight .err{color:#a61717;background-color:#e3d2d2}.highlight .k{font-weight:bold}.highlight .o{font-weight:bold}.highlight .cm{color:#998;font-style:italic}.highlight .cp{color:#999;font-weight:bold}.highlight .c1{color:#998;font-style:italic}.highlight .cs{color:#999;font-weight:bold;font-style:italic}.highlight .gd{color:#000;background-color:#fdd}.highlight .gd .x{color:#000;background-color:#faa}.highlight .ge{font-style:italic}.highlight .gr{color:#a00}.highlight .gh{color:#999}.highlight .gi{color:#000;background-color:#dfd}.highlight .gi .x{color:#000;background-color:#afa}.highlight .go{color:#888}.highlight .gp{color:#555}.highlight .gs{font-weight:bold}.highlight .gu{color:#800080;font-weight:bold}.highlight .gt{color:#a00}.highlight .kc{font-weight:bold}.highlight .kd{font-weight:bold}.highlight .kn{font-weight:bold}.highlight .kp{font-weight:bold}.highlight .kr{font-weight:bold}.highlight .kt{color:#458;font-weight:bold}.highlight .m{color:#099}.highlight .s{color:#d14}.highlight .na{color:#008080}.highlight .nb{color:#0086b3}.highlight .nc{color:#458;font-weight:bold}.highlight .no{color:#008080}.highlight .ni{color:#800080}.highlight .ne{color:#900;font-weight:bold}.highlight .nf{color:#900;font-weight:bold}.highlight .nn{color:#555}.highlight .nt{color:#000080}.highlight .nv{color:#008080}.highlight .ow{font-weight:bold}.highlight .w{color:#bbb}.highlight .mf{color:#099}.highlight .mh{color:#099}.highlight .mi{color:#099}.highlight .mo{color:#099}.highlight .sb{color:#d14}.highlight .sc{color:#d14}.highlight .sd{color:#d14}.highlight .s2{color:#d14}.highlight .se{color:#d14}.highlight .sh{color:#d14}.highlight .si{color:#d14}.highlight .sx{color:#d14}.highlight .sr{color:#009926}.highlight .s1{color:#d14}.highlight .ss{color:#990073}.highlight .bp{color:#999}.highlight .vc{color:#008080}.highlight .vg{color:#008080}.highlight .vi{color:#008080}.highlight .il{color:#099}.highlight .gc{color:#999;background-color:#eaf2f5}.type-csharp .highlight .k{color:#00F}.type-csharp .highlight .kt{color:#00F}.type-csharp .highlight .nf{color:#000;font-weight:normal}.type-csharp .highlight .nc{color:#2b91af}.type-csharp .highlight .nn{color:#000}.type-csharp .highlight .s{color:#a31515}.type-csharp .highlight .sc{color:#a31515}
</style>

</head>
<body class="normal">
  <div id="wrapper">
      <h1 id="webservermodule">webserver Module</h1>

<h2 id="description">Description</h2>

<p>Create a fully dynamic HTTP server inside your Titanium application.</p>

<h2 id="installation">Installation</h2>

<p><a href="">http://docs.appcelerator.com/titanium/2.0/index.html#!/guide/Using_a_Module</a></p>

<h3 id="ios4moduleonly">iOS &gt;= 4 module only</h3>

<p>This is an iOS &gt; = 4 module only! If you try to require it on an iOS &lt; = 3 device,
it will throw an exception. So you should include some sort of code on
your application to check in which version of iOS are you running, and then
decide to use or not use this module</p>

<pre><code>function isiOS4Plus()
{
  // add iphone specific tests
  if (Titanium.Platform.name == 'iPhone OS')
  {
    var version = Titanium.Platform.version.split(&quot;.&quot;);
    var major = parseInt(version[0],10);

    if (major &gt;= 4)
    {
      return true;
    }
  }
  return false;
}  
</code></pre>

<h2 id="changelog">Changelog</h2>

<p>See <a href="changelog.html">here</a></p>

<h2 id="accessingthewebservermodule">Accessing the webserver Module</h2>

<p>To access this module from JavaScript, you would do the following:</p>

<pre><code>var webserver = require(&quot;matt.webserver&quot;);
</code></pre>

<p>The webserver variable is a reference to the Module object. </p>

<h2 id="reference">Reference</h2>

<h3 id="webserver.startserver">webserver.startServer({&#8230;})</h3>

<p>Use this method to setup and start the server. The only argument is an object that
you should use to configure all aspects of the webserver instance:</p>

<ul>
<li><p><em>port</em>: [required] An integer with the port number you want to run the server. Please use
 only unprivileged ports (&gt; 1024). Default is 12345.</p></li>
<li><p><em>documentRoot</em>: [required] The document root of the web server (where static files will be served from).
 The default is the Application documents directory.</p></li>
<li><p><em>bonjour</em>: [optional] default to <code>true</code>. Enables Bonjour advertising for the webserver.</p></li>
<li><p><em>requestCallback</em>: [required] A callback that is called for every single HTTP request to the webserver.
 The details about this callback are explained on the next section</p></li>
</ul>

<p>After this call, the server is running and should be ready to receive requests on the device.</p>

<p>Example:</p>

<pre><code>var webserver = require('matt.webserver');
var server = webserver.startServer({
  port: 12345,
  documentRoot: Ti.Filesystem.tempDirectory,
  requestCallback: function(e) {
    return &quot;Hello World!&quot;;
  }
});
</code></pre>

<p>This would start the webserver on port 12345 and reply to all requests with the
string <code>Hello World</code>.</p>

<h3 id="requestcallback">requestCallback</h3>

<h3 id="eventparams">event params</h3>

<p>Under the <code>event</code> object passed as paramter, there are a lot of keys depending on
the request. Here&#8217;s the summary:</p>

<ul>
<li><p><em>method</em>: The HTTP method used for this request: (&#8220;GET&#8221;, &#8220;POST&#8221;, &#8220;PUT&#8221;, &#8220;DELETE&#8221;)</p></li>
<li><p><em>path</em>: The relative path for the request</p></li>
</ul>

<p>Example:</p>

<pre><code># curl -v http://localhost:12345/foo/bar
requestCallback: function(e) {
  alert(e.path); // should print &quot;/foo/bar&quot;
}
</code></pre>

<ul>
<li><p><em>headers</em>: An object with all the headers for the request</p></li>
<li><p><em>get</em>: A (possible empty) object with all the GET params sent on this request.</p></li>
</ul>

<p>Example:</p>

<pre><code># curl -v http://localhost:12345/?foo=bar

requestCallback: function(e) {
  alert(e.get.foo); // should print &quot;bar&quot;
}
</code></pre>

<ul>
<li><em>post</em>: A (possible empty) object with all the POST params sent on this request.
 This includes all paramters encoded as <code>application/x-www-form-urlencoded</code>.
 This never includes <code>GET</code> params, neither files sent in the <code>multipart</code> format.</li>
</ul>

<p>Example:</p>

<pre><code># curl -d &quot;post_name=post_value&quot; http://localhost:12345/?foo=bar

requestCallback: function(e) {
  alert(e.post.post_name); // should print &quot;post_value&quot;
  alert(e.post.foo); // should print null
}
</code></pre>

<ul>
<li><em>files</em>: A (possible empty) object with all the files sent as <code>multipart/form-data</code>. The keys
 correspond to the file name, and the values are <code>TiBlob</code>s you can read, copy, write, etc.</li>
</ul>

<p>Example:</p>

<pre><code># curl -d&quot;file_name=@/bin/sh&quot; http://localhost:12345/?foo=bar

requestCallback: function(e) {
  alert(e.files.file_name); // should print the file contents
}
</code></pre>

<ul>
<li><em>body</em>: An optional <code>TiBlob</code> that only appears when the webserver receives a raw request with no known
 <code>Content-Type</code>. Since it can&#8217;t handle with both <code>multipart</code> neither with <code>form-urlencoded</code>, the
 full raw body is returned here in a <code>TiBlob</code> that you can process, save to a file, or do any
 other thing.</li>
</ul>

<h3 id="responsevalues">Response values</h3>

<p>Currently there are two types of responses supported by the module:</p>

<h4 id="basicstringresponse">Basic string response</h4>

<p>You just return a string from the callback, and it sent directly to the client.</p>

<p>Example:</p>

<pre><code>requestCallback: function(e) {
  return &quot;Hello world&quot;;
}
</code></pre>

<h4 id="advancedobjectresponse">Advanced object response</h4>

<p>You could however return a response that allows for more advanced stuff. The object
should contain the following keys:</p>

<ul>
<li><em>headers</em>: [optional] An object with the headers you want to send with the response</li>
</ul>

<p>Example:</p>

<pre><code>requestCallback: function(e) {
  return {
    headers: { 'Content-Type': 'application/json' }
  }
}
</code></pre>

<ul>
<li><em>body</em>: [required or file] A string with the body to be returned to client</li>
</ul>

<p>Example:</p>

<pre><code>requestCallback: function(e) {
  return {
    headers: { 'Content-Type': 'application/json' },
    body: &quot;{foo:'bar'}&quot;
  }
}
</code></pre>

<ul>
<li><em>file</em>: [required or body] A TiBlob representing an existing file to be sent to the client.
 Under the hood it uses a very efficient mechanism to load the file to the client
 without exausting all the resources.</li>
</ul>

<p>Example:</p>

<pre><code>requestCallback: function(e) {
  return {
    headers: { 'Content-Type': 'image/png' },
    file: Ti.Filesystem.getFile(Ti.Filesystem.resourcesDirectory, &quot;KS_nav_ui.png&quot;)
  }
}
</code></pre>

<h2 id="events">Events</h2>

<h3 id="requeststarted">requestStarted</h3>

<p>The server sends this event everytime a request is started. The object passed as
argument is the same object passed to the <code>requestCallback</code> bellow.</p>

<h2 id="usage">Usage</h2>

<p>Please see the example director, since it contains several examples of all the API.</p>

<h2 id="author">Author</h2>

<p>Matt Apperson</p>

<p>Ruben Fonseca</p>

<p>(c) 2012</p>
    </div>
</body>
</html>